"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray"),_slicedToArray3=_interopRequireDefault(_slicedToArray2),_extends2=require("babel-runtime/helpers/extends"),_extends3=_interopRequireDefault(_extends2),_toConsumableArray2=require("babel-runtime/helpers/toConsumableArray"),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),_react=require("react"),_react2=_interopRequireDefault(_react),_uuid=require("uuid"),_chess=require("chess.js"),_chess2=_interopRequireDefault(_chess),_chessSets=require("./chess-sets"),_chessSets2=_interopRequireDefault(_chessSets),steimberg=155978933,ChessBoard=function(e){/* End of general functions */
/*
  const unflippedRows = [ChessBoard.range(56), ChessBoard.range(48), ChessBoard.range(40), ChessBoard.range(32), ChessBoard.range(24), ChessBoard.range(16), ChessBoard.range(8), ChessBoard.range()]
  const flippedRows = [ChessBoard.range(7, -1), ChessBoard.range(15, 7), ChessBoard.range(23, 15), ChessBoard.range(31, 23), 
                      ChessBoard.range(39, 31), ChessBoard.range(47, 39), ChessBoard.range(55, 47), ChessBoard.range(63, 55)]
  */
function t(e){(0,_classCallCheck3.default)(this,t);var r=(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).call(this,e));return r.drawDiagram=function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.state.size,n=void 0,o=void 0,a=void 0,i=void 0,l=void 0,u=r.figuresCurrent(),c=s/8;for(o=0;o<4;o++){for(n=0;n<4;n++)a=n*(2*c),i=o*(2*c),e.fillStyle=r.state.lightSqsBg,e.fillRect(a,i,a+c,i+c),a=n*(2*c)+c,e.fillStyle=r.state.darkSqsBg,e.fillRect(a,i,a+c,i+c);for(n=0;n<4;n++)a=n*(2*c),i=o*(2*c)+c,e.fillStyle=r.state.darkSqsBg,e.fillRect(a,i,a+c,i+c),a=n*(2*c)+c,e.fillStyle=r.state.lightSqsBg,e.fillRect(a,i,a+c,i+c)}
// console.log(arr)
for(var d=0;d<64;d++)if("0"!==u[d]){l=new Image,l.src=t.chessSets[r.state.chessSet][u[d]];var g=r.state.flipped?7^d:56^d;i=t.row(56^g)*c,a=t.col(56^g)*c,e.drawImage(l,a,i,c,c)}return"Done"},r.on=function(e,t){var s=(0,_uuid.v4)();return r.subscribers=[].concat((0,_toConsumableArray3.default)(r.subscribers),[{id:s,event:e,callback:t}]),function(){return r.subscribers=r.subscribers.filter(function(e){return e.id!==s})}},r.emit=function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return r.subscribers.filter(function(t){return t.event===e}).forEach(function(e){return e.callback.apply(e,s)})},r.doScroll=function(){return r.refs.notation.scrollTop=r.refs.notation.scrollHeight},r.useSet=function(e){return r.setState({chessSet:e})},r.useSquares=function(e){return r.setState({lightSqsBg:t.lightSqBgs[e],darkSqsBg:t.darkSqBgs[e]})},r.goto=function(e){var s=void 0;s=e>=r.state.positions.length?r.state.positions.length-1:e<0?0:e,r.setState({currentPosition:s}),r.emit(t.Events.CHANGE,s)},r.previous=function(){return r.goto(r.state.currentPosition-1)},r.next=function(){return r.goto(r.state.currentPosition+1)},r.last=function(){return r.goto(r.state.positions.length-1)},r.first=function(){return r.goto(0)},r.empty=function(){r.props.moveValidator&&r.game.load(t.emptyFen),r.setState({positions:[t.emptyFen],currentPosition:0,movements:[]})},r.resetBaseHeaders=function(){r.setState({whitePlayer:r.props.whitePlayer||t.defaultSettings.whitePlayer,blackPlayer:r.props.blackPlayer||t.defaultSettings.blackPlayer,gameDate:t.date2pgn(new Date)})},r.setBaseHeaders=function(){r.props.moveValidator&&r.game.header("White",r.state.whitePlayer,"Black",r.state.blackPlayer,"Date",r.state.gameDate)},r.reset=function(){return r.resetBaseHeaders(),r.props.moveValidator&&(r.game.reset(),r.setBaseHeaders()),r.setState({positions:[t.defaultFen],currentPosition:0,movements:[]}),r.emit(t.Events.CHANGE,0),!0},r.loadFen=function(e){var s=!0;return r.props.moveValidator&&(s=r.game.load(e)),s?(r.setState({positions:[e],currentPosition:0,movements:[]}),r.resetBaseHeaders(),r.setBaseHeaders(),r.emit(t.Events.CHANGE,0)):r.emit(t.Events.ERROR,t.Messages.ERROR_LOAD_FEN,""),s},r.loadPgn=function(e){if(!r.props.moveValidator)return!1;var s=r.game.load_pgn(e);if(s){var n=r.game.header();r.setState({positions:r.game.fens(),currentPosition:0,movements:r.game.history(),whitePlayer:n.White,blackPlayer:n.Black,gameDate:n.Date,gameResult:n.Result}),r.emit(t.Events.CHANGE,0)}return s},r.takeback=function(){if(1===r.state.positions.length)return!1;r.props.moveValidator&&r.game.undo();var e=r.props.moveValidator?r.game.fens():r.state.positions.slice(0,r.state.positions.length-1);return r.setState({positions:e,currentPosition:e.length-1,movements:r.props.moveValidator?r.game.history():r.state.movements.slice(0,r.state.movements.length-1)}),r.emit(t.Events.CHANGE,e.length-1),!0},r.san2fig=function(e){return e.replace(/[NBRQK]/,function(e){return"w"==r.game.turn()?e.toLowerCase():e}).replace(/[NBRQKnbrqk]/,function(e){return t.Figurines[e].html})},r.isFlipped=function(){return r.state.flipped},r.paramFromPosition=function(e,t){return r.state.positions[e].split(/\s+/)[t]},r.figuresFromPosition=function(e){return t.expandPosition(r.state.positions[e].split(/\s+/)[0])},r.whoMovesFromPosition=function(e){return r.state.positions[e].split(/\s+/)[1]},r.castlingFromPosition=function(e){return r.state.positions[e].split(/\s+/)[2]},r.enPassantFromPosition=function(e){return r.state.positions[e].split(/\s+/)[3]},r.halfMoveClockFromPosition=function(e){return parseInt(r.state.positions[e].split(/\s+/)[4])},r.moveNumberFromPosition=function(e){return parseInt(r.state.positions[e].split(/\s+/)[5])},r.figuresCurrent=function(){return r.figuresFromPosition(r.state.positions.length-1)},r.whoMovesCurrent=function(){return r.whoMovesFromPosition(r.state.positions.length-1)},r.castlingCurrent=function(){return r.castlingFromPosition(r.state.positions.length-1)},r.enPassantCurrent=function(){return r.enPassantFromPosition(r.state.positions.length-1)},r.halfMoveClockCurrent=function(){return r.halfMoveClockFromPosition(r.state.positions.length-1)},r.moveNumberCurrent=function(){return r.moveNumberFromPosition(r.state.positions.length-1)},r.setPlayer=function(e,t){"w"===e?r.setState({whitePlayer:t}):r.setState({blackPlayer:t}),r.setBaseHeaders()},r.setDate=function(e){r.setState({gameDate:t.date2pgn(e)}),r.setBaseHeaders()},r.setSize=function(e){r.setState({size:e})},r.flip=function(){var e=!r.state.flipped;r.setState({flipped:e}),r.emit(t.Events.FLIP,e)},r.setHeader=function(e,t){if(r.props.moveValidator){r.game.header(e,t);var s={};s[e]=t,r.setState(s)}},r.getPgnText=function(){if(!r.props.moveValidator||!r.game)return"";var e=document.getElementsByClassName("annotation"),t=e?e[0]:null,s=t?t.scrollHeight:200;
//console.log("Scroll height: ", hei)
e&&e.forEach&&e.forEach(function(e){return e.scrollTop=s}),t&&(t.scrollTop=s);var n=r.game?r.game.header():{},o=[];for(var a in n)o.push(a);var i=o.map(function(e,t){return _react2.default.createElement("p",{style:{margin:"1pt"},key:t},"[",e,' "',n[e],'"]')}),l=r.game?r.game.history():r.state.movements,u=l.map(function(e,t){return _react2.default.createElement("span",{key:t+1,style:{cursor:"pointer",backgroundColor:t+1===r.state.currentPosition?r.state.lightSqsBg:"white"},title:"",onClick:function(e){return r.goto(t+1)}},r.state.positions[t]&&"w"===r.state.positions[t].split(/\s+/)[1]?r.state.positions[t].split(/\s+/)[5]+". ":0===t?r.state.positions[t].split(/\s+/)[5]+". ... ":"",e," ")});return _react2.default.createElement("div",{ref:"annotation",className:"annotation"},i,_react2.default.createElement("p",{style:{margin:"1pt"}},_react2.default.createElement("span",{key:0,style:{cursor:"pointer",backgroundColor:0===r.state.currentPosition?r.state.lightSqsBg:"white"},onClick:function(e){return r.goto(0)}},"   "),u))},r.getCrowning=function(e,s,n){r.crowningInfo={sqFrom:e,sqTo:s,figureFrom:n,sqColor:t.isBlackSquare(56^s)?"b":"w",figColor:t.figureColor(n),top:r.refs[t.sq2san(56^s)].offsetTop,left:r.refs[t.sq2san(56^s)].offsetLeft},r.setState({isCrowning:!0})},r.move=function(){for(var e=arguments.length,s=Array(e),n=0;n<e;n++)s[n]=arguments[n];if(r.state.currentPosition!==r.state.positions.length-1)return r.emit(t.Events.ERROR,t.Messages.ERROR_PREV_POS,"");var o=s.length;if(0===o||2===o)return r.emit(t.Events.ERROR,t.Messages.ERROR_MOVE_ARGS,o);var a=s[0],i=s[1],l=s[2],u=s[3];if(o>1&&r.whoMovesCurrent()!==t.figureColor(l))return r.emit(t.Events.ERROR,t.Messages.ERROR_MOVE_TURN,t.figureColor(l));if(!u&&("p"===l&&0===t.row(56^i)||"P"===l&&7===t.row(56^i)))return void r.getCrowning(a,i,l);if(1===o&&!r.props.moveValidator)return r.emit(t.Events.ERROR,t.Messages.ERROR_CANT_PROCESS_SAN,"");if(!r.props.moveValidator&&o>1){var c=void 0;if(u){var d=[l,u];c=d[0],l=d[1]}else c=l;var g=[].concat((0,_toConsumableArray3.default)(r.figuresCurrent()));g[a]="0",g[i]=l,"k"===l&&4===a&&2===i&&(g[0]="0",g[3]="r"),"k"===l&&4===a&&6===i&&(g[7]="0",g[5]="r"),"K"===l&&60===a&&58===i&&(g[56]="0",g[59]="R"),"K"===l&&60===a&&62===i&&(g[63]="0",g[61]="R");var p=r.state.positions.length,h=t.compressPosition(g.join("")),f="w"===r.whoMovesCurrent()?"b":"w",m=r.castlingCurrent(),S=m;"K"===l&&(S=m.replace(/K/,"").replace(/Q/,"")),"k"===l&&(S=m.replace(/k/,"").replace(/q/,"")),"R"===l&&0==(56^a)&&(S=m.replace(/Q/,"")),"R"===l&&7==(56^a)&&(S=m.replace(/K/,"")),"r"===l&&56==(56^a)&&(S=m.replace(/q/,"")),"r"===l&&63==(56^a)&&(S=m.replace(/k/,"")),S=0===S.length?"-":S;var C="-";if(("p"===l||"P"===l)&&16===Math.abs(i-a)){var E="P"===l?8:-8;C=t.sq2san(i+E^56)}var v=r.halfMoveClockCurrent()+1;"p"!==l&&"P"!==l&&"0"===r.figuresCurrent()[i]||(v=0);var _=r.moveNumberCurrent();"w"===f&&_++,r.setState({currentPosition:p,positions:[].concat((0,_toConsumableArray3.default)(r.state.positions),[[h,f,S,C,v,_].join(" ")]),movements:[].concat((0,_toConsumableArray3.default)(r.state.movements),[{sqFrom:a,sqTo:i,figure:c,crowning:u}])}),r.emit(t.Events.CHANGE,p),r.emit(t.Events.MOVE,r.state.movements[r.state.movements.length-1])}else{var b=void 0;1===o?b=s[0]:(b={from:t.sq2san(56^a),to:t.sq2san(56^i)},b=u?(0,_extends3.default)({},b,{promotion:u.toLowerCase()}):b);if(!r.game.move(b))return r.emit(t.Events.ERROR,t.Messages.ERROR_WRONG_MOVE,"");var P=r.game.fens().length-1,B=r.game.history(),q=B[B.length-1],w=r.state.positions[r.state.positions.length-1].split(/\s+/)[5],y="b"===r.game.turn()?".":". ...";if(r.setState({currentPosition:P,positions:r.game.fens(),movements:r.game.history()}),r.emit(t.Events.CHANGE,P),r.emit(t.Events.MOVE,q),r.game.in_check()&&!r.game.in_checkmate()&&r.emit(t.Events.CHECK,t.Messages.CHECK,""+w+y+" "+q),r.game.game_over())if(r.game.in_checkmate()){var R="b"===r.game.turn()?["1-0",w+"."]:["0-1",w+". ..."],D=(0,_slicedToArray3.default)(R,2),k=D[0],F=D[1];r.game.header("Result",k),r.setState({gameResult:k}),r.emit(t.Events.CHECK_MATE,t.Messages.CHECK_MATE,""+F+q,k)}else r.game.in_draw()&&(r.game.insufficient_material()||r.game.in_stalemate())&&(r.game.header("Result","1/2-1/2"),r.setState({gameResult:"1/2-1/2"}),r.game.in_stalemate()?r.emit(t.Events.STALE_MATE,t.Messages.STALE_MATE,"1/2-1/2"):r.emit(t.Events.INSUFFICIENT_MATERIAL,t.Messages.INSUFFICIENT_MATERIAL,"1/2-1/2"))}},r.onSquareClick=function(e,t,s){
//if (this.whoMovesCurrent() !== ChessBoard.figureColor(figure) && this.sqFrom === -1) {
//this.sqFrom = -1
//this.figureFrom = -1
//this.setState({selectedSq: -1})
//  return
//}
if(s.preventDefault(),-1===r.sqFrom){if("0"===t)return;r.sqFrom=e,r.figureFrom=t,r.setState({selectedSq:e,isDragging:!1})}else r.sqFrom===e?(r.sqFrom=-1,r.figureFrom="",r.setState({selectedSq:-1})):(r.move(r.sqFrom,e,r.figureFrom),r.sqFrom=-1,r.figureFrom="",r.setState({selectedSq:-1}))},r.onFigureDragStart=function(e,t,s){var n=r.state.size/8,o=n/2,a=document.createElement("canvas").getContext("2d");a.canvas.width=n,a.canvas.height=n;var i=new Image;i.src=s.target.src,a.drawImage(i,0,0,n,n),s.dataTransfer.setDragImage(a.canvas,o,o),r.sqFrom=e,r.figureFrom=t,console.log(r.sqFrom),r.setState({selectedSq:e,isDragging:!0})},r.onFigureDragEnd=function(e){var s=void 0;
//console.log("onFigureDragEnd")
-1!==r.state.selectedSq&&r.state.mode===t.Modes.MODE_SETUP&&(s=r.putSquare(r.state.selectedSq,"0"),r.setState({positions:[s],selectedSq:-1})),r.setState({isDragging:!1})},r.onSquareDrop=function(e,s){
//console.log(`onSquareDrop(sq=${sq}, san=${ChessBoard.sq2san(sq ^ 56)})`)
if(s.preventDefault(),e===r.sqFrom||r.state.mode!==t.Modes.MODE_SETUP&&r.whoMovesCurrent()!=t.figureColor(r.figureFrom))return r.sqFrom=-1,r.figureFrom="",void r.setState({selectedSq:-1});if(r.state.mode===t.Modes.MODE_SETUP){
//console.log("onSquareDrop")
var n=r.putSquare(e,r.figureFrom);return r.setState({positions:[n]}),r.sqFrom=-1,void(r.figureFrom="")}r.move(r.sqFrom,e,r.figureFrom),r.sqFrom=-1,r.figureFrom="",r.setState({selectedSq:-1})},r.setup=function(){return r.setState({positions:[r.state.positions[r.state.currentPosition]],currentPosition:0,mode:t.Modes.MODE_SETUP})},r.analyze=function(){return r.setState({mode:t.Modes.MODE_ANALIZE})},r.view=function(){return r.setState({mode:t.Modes.MODE_VIEW})},r.play=function(){return r.setState({mode:t.Modes.MODE_PLAY})},r.putSquare=function(e,s){var n=r.state.positions[r.state.currentPosition].split(/\s+/),o=(0,_slicedToArray3.default)(n,6),a=o[0],i=o[1],l=o[2],u=o[3],c=o[4],d=o[5],g=t.expandPosition(a).split("");return g[e]=s,[t.compressPosition(g.join("")),i,l,u,c,d].join(" ")},r.toggleNotation=function(){return r.setState({hideNotation:!r.state.hideNotation})},r.subscribers=[],r.state={mode:r.props.mode||t.defaultSettings.mode,size:r.props.size||t.defaultSettings.size,flipped:r.props.flipped||t.defaultSettings.flipped,chessSet:r.props.chessSet||t.defaultSettings.chessSet,currentPosition:r.props.currentPosition||t.defaultSettings.currentPosition,positions:r.props.positions||t.defaultSettings.positions,movements:r.props.movements||t.defaultSettings.movements,lightSqsBg:r.props.lightSqsBg||t.defaultSettings.lightSqsBg,darkSqsBg:r.props.darkSqsBg||t.defaultSettings.darkSqsBg,selectedSqBg:r.props.selectedSqBg||t.defaultSettings.selectedSqBg,showNotation:r.props.showNotation||t.defaultSettings.showNotation,whitePlayer:r.props.whitePlayer||t.defaultSettings.whitePlayer,blackPlayer:r.props.blackPlayer||t.defaultSettings.blackPlayer,hideNotation:r.props.hideNotation||t.defaultSettings.hideNotation,gameDate:t.date2pgn(new Date),selectedSq:-1,isDragging:!1,isCrowning:!1},r.sqFrom=-1,r.figureFrom="",r.moveValidator=e.moveValidator||null,r}/* General functions */
return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"componentDidMount",value:function(){
//Waring! Delete next line in production!!!
window.board1=this,this.props.moveValidator&&(this.game=new _chess2.default(this.state.positions[0]),this.setBaseHeaders())}},{key:"render",value:function(){var e=this,r=t.chessSets[this.state.chessSet].size,s=t.expandPosition(this.state.positions[this.state.currentPosition].split(/\s+/)[0]),n=this.state.flipped?t.range(7,-1).map(function(e){return t.range(8*e+7,8*e-1)}):t.range().map(function(e){return t.range(8*e,8*e+8)}),o=n.map(function(n,o){var a=e.state.flipped?o:7-o;return _react2.default.createElement("div",{key:a,ref:"row_"+a,style:{height:e.state.size/8+"px",width:e.state.size+"px",textAlign:"center",backgroundColor:"#3333333",opacity:e.state.isCrowning?"0.5":"1"}},n.map(function(n,o){var a=t.sq2san(56^n),i=s[n],l=void 0;return l="0"===i?"":_react2.default.createElement("img",{src:t.chessSets[e.state.chessSet][i],draggable:(t.figureColor(i),e.whoMovesCurrent(),!0),figure:i,color:t.figureColor(i),style:{width:r+"%",height:r+"%",cursor:t.figureColor(i)===e.whoMovesCurrent()?"pointer":"not-allowed",opacity:e.state.isDragging&&e.state.selectedSq===n?"0":"1"},onDragStart:function(t){return e.onFigureDragStart(n,i,t)},onDragEnd:function(t){return e.onFigureDragEnd(t)}}),_react2.default.createElement("div",{key:n,onClick:function(t){return e.onSquareClick(n,i,t)},onDragOver:function(e){e.preventDefault()},onDrop:function(t){return e.onSquareDrop(n,t)},className:n===e.state.selectedSq?"selectedSq":"unselectedSq",style:{display:"inline-block",width:e.state.size/8+"px",height:e.state.size/8+"px",verticalAlign:"middle",textAlign:"center",paddingTop:100===r?0:(100-r)/10+"%",backgroundColor:n===e.state.selectedSq?e.state.selectedSqBg:t.isBlackSquare(56^n)?e.state.darkSqsBg:e.state.lightSqsBg},ref:a,tooltip:a,color:t.isBlackSquare(56^n)?"b":"w"},l)}))});return _react2.default.createElement("div",{style:{display:"inline-block"},onDoubleClick:function(){return e.flip()}},_react2.default.createElement("div",{style:{width:this.state.size+"px",height:this.state.size+"px",border:"solid 1px navy",backgroundColor:"#333333",opacity:this.state.isCrowning?"0.8":"1"}},o,_react2.default.createElement("div",{ref:"crowningPanel",style:{width:this.state.size/2,height:this.state.size/8,color:"white",display:this.state.isCrowning?"block":"none",position:"fixed",left:this.crowningInfo?this.crowningInfo.left:0,top:this.crowningInfo?this.crowningInfo.top:0,zIndex:"100"}},["q","n","r","b"].map(function(t){return e.crowningInfo&&"w"===e.crowningInfo.figColor?t.toUpperCase():t}).map(function(r,s){var n=e.state.size/8,o="crowning_"+r;return _react2.default.createElement("div",{style:{display:"inline-block",width:n,height:n,backgroundColor:e.crowningInfo?"b"===e.crowningInfo.sqColor?e.state.darkSqsBg:e.state.lightSqsBg:e.state.darkSqsBg},onClick:function(t){var s=e.crowningInfo,n=s.sqFrom,o=s.sqTo,a=s.figureFrom;e.setState({isCrowning:!1}),
// console.log(`figureFrom: ${figureFrom} - figure: ${figure}`)
e.move(n,o,a,r)},ref:o,key:s},_react2.default.createElement("img",{src:t.chessSets[e.state.chessSet][r],style:{width:"100%",height:"100%",cursor:"pointer"}}))}))),_react2.default.createElement("div",{ref:"notation",style:{display:this.state.hideNotation||!this.props.moveValidator||this.state.mode===t.Modes.MODE_SETUP?"none":"inherit",border:"solid 1px navy",borderTop:"none",width:this.state.size+"px",height:parseInt(this.state.size/4)+"px",overflow:"auto",fontSize:"12pt"}},this.getPgnText()),_react2.default.createElement("div",{ref:"setup_panel",style:{display:this.state.mode!==t.Modes.MODE_SETUP?"none":"inherit",border:"solid 1px navy",borderTop:"none",width:this.state.size+"px",
//height: `${parseInt(this.state.size / 3)}px`,
height:"150px",overflow:"auto",fontSize:"12pt",backgroundColor:this.state.lightSqsBg}},_react2.default.createElement("div",{style:{paddingLeft:"10px",paddingTop:"0"}},_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"p"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"p",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].p,figure:"p",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"P"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"P",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].P,figure:"P",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"n"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"n",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].n,figure:"n",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"N"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"N",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].N,figure:"N",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"b"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"b",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].b,figure:"b",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"B"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"B",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].B,figure:"B",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px",marginLeft:"20px"}},_react2.default.createElement("button",{onClick:function(){return e.empty()}},"Empty")),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px",marginLeft:"20px"}},_react2.default.createElement("button",{onClick:function(){return e.reset()}},"Initial"))),_react2.default.createElement("div",{style:{paddingLeft:"10px",paddingTop:"0"}},_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"r"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"r",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].r,figure:"r",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"R"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"R",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].R,figure:"R",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"q"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"q",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].q,figure:"q",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"Q"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"Q",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].Q,figure:"Q",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"k"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"k",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].k,figure:"k",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px"},figure:"K"},_react2.default.createElement("img",{onDragStart:function(t){return e.onFigureDragStart(-1,"K",t)},onDragEnd:function(t){return e.onFigureDragEnd(t)},src:t.chessSets[this.state.chessSet].K,figure:"K",draggable:!0,width:"100%",height:"100%"})),_react2.default.createElement("div",{style:{display:"inline-block",height:"50px",width:"50px",border:"solid 1 px",marginLeft:"20px"}},_react2.default.createElement("button",{onClick:function(){e.loadFen(e.state.positions[0]),e.analyze()}},"Done")))))}}]),t}(_react.Component);ChessBoard.version="0.4.7",ChessBoard.Modes={MODE_SETUP:"MODE_SETUP",MODE_ANALYSIS:"MODE_ANALYSIS",MODE_VIEW:"MODE_VIEW",MODE_PLAY:"MODE_PLAY"},ChessBoard.range=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e+8,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e===t?r:ChessBoard.range(e<t?e+1:e-1,t,[].concat((0,_toConsumableArray3.default)(r),[e]))},ChessBoard.compose=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce(function(e,t){return t(e)},e)}},ChessBoard.partition=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.length>0?ChessBoard.partition(e.slice(t),t,[].concat((0,_toConsumableArray3.default)(r),[e.slice(0,t)])):r},ChessBoard.partPosition=function(e){return ChessBoard.partition([].concat((0,_toConsumableArray3.default)(e))).map(function(e){return e.join("")}).join("/")},ChessBoard.compressPosition=function(e){return ChessBoard.partPosition(e).replace(/0+/g,function(e){return e.length.toString()})},ChessBoard.expandPosition=function(e){return e.replace(/\//g,"").replace(/[1-8]/g,function(e){return ChessBoard.range(0,parseInt(e)).map(function(e){return"0"}).join("")})},ChessBoard.sqBgLabels=["Blue","Brown","Acqua","Maroon"],ChessBoard.lightSqBgs=["#add8e6","#f0d9b5","#dfdfdf","#FFF2D7"],ChessBoard.darkSqBgs=["#6495ed","#b58863","#56b6e2","#B2535B"],ChessBoard.selectedSqBg="#bfd",ChessBoard.emptyPosition=ChessBoard.range(0,64).map(function(e){return"0"}).join(""),ChessBoard.defaultPosition="rnbqkbnrpppppppp00000000000000000000000000000000PPPPPPPPRNBQKBNR",ChessBoard.sicilianPosition="rnbqkbnrpp0ppppp0000000000p000000000P00000000000PPPP0PPPRNBQKBNR",ChessBoard.emptyFen="8/8/8/8/8/8/8/8 w KQkq - 0 1",ChessBoard.defaultFen="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",ChessBoard.sicilianFen="rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 1",ChessBoard.pgnTagLineRE=/^\s*\[\s*(.+?)\s+"(.+?)"\s*\]\s*$/,ChessBoard.sanRE=/(?:(^0-0-0|^O-O-O)|(^0-0|^O-O)|(?:^([a-h])(?:([1-8])|(?:x([a-h][1-8])))(?:=?([NBRQ]))?)|(?:^([NBRQK])([a-h])?([1-8])?(x)?([a-h][1-8])))(?:(\+)|(#)|(\+\+))?$/,ChessBoard.defaultSettings={size:400,flipped:!1,chessSet:"default",currentPosition:0,positions:[ChessBoard.defaultFen],lightSqsBg:ChessBoard.lightSqBgs[0],darkSqsBg:ChessBoard.darkSqBgs[0],selectedSqBg:ChessBoard.selectedSqBg,movements:[],isCrowning:!1,showNotation:!0,whitePlayer:"White Player",blackPlayer:"Black Player",lang:"en",mode:ChessBoard.Modes.MODE_ANALYSIS,hideNotation:!1},ChessBoard.row=function(e){return parseInt(e/8)},ChessBoard.col=function(e){return e%8},ChessBoard.difCol=function(e,t){return Math.abs(ChessBoard.col(e)-ChessBoard.col(t))},ChessBoard.difRow=function(e,t){return Math.abs(ChessBoard.row(e)-ChessBoard.row(t))},ChessBoard.isSameCol=function(e,t){return 0===ChessBoard.difCol(e,t)},ChessBoard.isSameRow=function(e,t){return 0===ChessBoard.difRow(e,t)},ChessBoard.isDiagonal=function(e,t){return e!=t&&ChessBoard.difRow(e,t)===ChessBoard.difCol(e,t)},ChessBoard.isAntiDiagonal=function(e,t){return ChessBoard.isDiagonal(e,t)&&Math.abs(e-t)%7==0},ChessBoard.isBlackSquare=function(e){return ChessBoard.row(e)%2==0&&ChessBoard.col(e)%2==0||ChessBoard.row(e)%2==1&&ChessBoard.col(e)%2==1},ChessBoard.sq2san=function(e){return e>=0&&e<64?""+String.fromCharCode(97+ChessBoard.col(e))+(ChessBoard.row(e)+1):"-"},ChessBoard.san2sq=function(e){return e.charCodeAt(0)-97+8*(parseInt(e[1])-1)},ChessBoard.figureColor=function(e){return e?e===e.toLowerCase()?"b":"w":"-"},ChessBoard.date2pgn=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},ChessBoard.letter2img={p:"p.png",P:"pw.png",n:"n.png",N:"nw.png",b:"b.png",B:"bw.png",r:"r.png",R:"rw.png",q:"q.png",Q:"qw.png",k:"k.png",K:"kw.png"},ChessBoard.chessSets={alt1:_chessSets2.default.alt1,default:_chessSets2.default.default,eyes:_chessSets2.default.eyes,fantasy:_chessSets2.default.fantasy,modern:_chessSets2.default.modern,spatial:_chessSets2.default.spatial,veronika:_chessSets2.default.veronika},ChessBoard.Events={CHECK_MATE:"CHECK_MATE",CHECK:"CHECK",DRAW:"DRAW",STALE_MATE:"STALE_MATE",INSUFFICIENT_MATERIAL:"INSUFFICIENT_MATERIAL",MOVE:"MOVE",ERROR:"ERROR",CHANGE:"CHANGE",FLIP:"FLIP"},ChessBoard.Messages={CHECK_MATE:{en:"Checkmate",es:"Jaque Mate"},CHECK:{en:"Check",es:"Jaque"},STALE_MATE:{en:"Stalemate draw",es:"Tablas por mate ahogado"},INSUFFICIENT_MATERIAL:{en:"Draw for insufficient material",es:"Tablas por material insuficiente"},WRONG_MOVE:{en:"Wrong move",es:"Movimiento incorrecto"},ERROR_LOAD_FEN:{en:"Could not load position",es:"No se pudo cargar la posición"},ERROR_PREV_POS:{en:"Attempt to move from a non last position",es:"Intento de mover desde una posición que no es la última"},ERROR_MOVE_ARGS:{en:"Move called with wrong number of arguments",es:"Función 'move' invocada con número incorrecto de argumentos"},ERROR_MOVE_TURN:{en:"Attempt to move the wrong color",es:"Intento de mover el color equivocadd"},ERROR_CANT_PROCESS_SAN:{en:"Can't process standard algebraic notation (SAN) move without a move validator",es:"No se puede procesar movimiento en notación algebraica estandard (SAN) sin un validador de movimientos"},ERROR_WRONG_MOVE:{en:"Wrong move",es:"Movida errónea"}},ChessBoard.Figurines={p:{codePoint:"0x265f",html:"&#9823;"},n:{codePoint:"0x265e",html:"&#9822;"},b:{codePoint:"0x265d",html:"&#9821;"},r:{codePoint:"0x265c",html:"&#9820;"},q:{codePoint:"0x265b",html:"&#9819;"},k:{codePoint:"0x265a",html:"&#9818;"},P:{codePoint:"0x2659",html:"&#9817;"},N:{codePoint:"0x2658",html:"&#9816;"},B:{codePoint:"0x2657",html:"&#9815;"},R:{codePoint:"0x2656",html:"&#9814;"},Q:{codePoint:"0x2655",html:"&#9813;"},K:{codePoint:"0x2654",html:"&#9812;"}},ChessBoard.getAvailSqColors=function(){return{light:ChessBoard.lightSqBgs,dark:ChessBoard.darkSqBgs,labels:ChessBoard.sqBgLabels}},exports.default=ChessBoard;
